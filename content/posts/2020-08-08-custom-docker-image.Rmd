---
title: Custom Docker Image
author: Michael Bach
date: '2020-08-08'
slug: custom-docker-image
categories: ["development"]
images: ~
---

![](/images/Docker_logo.png)

---------------------------------------

> **TL;DR**
>
> Creating your own Docker image is fairly easy, when using a parent image. Basically, you pull the parent image and set up your specifications according to your needs for your custom container. You can specify pretty much everything in your *Dockerfile*.

---------------------------------------

In this post I'd like to give a quick overview of how to customize a python container image to run your app or to use it as playground. You could either build an image from scratch of use a parent image and customize it to your needs. I'll focus on customizing a parent image as it suits my needs perfectly. Creating your own image might be necessary for certain usecases. However, most of the time it's sufficient building on a parent image as many smart people already invested some time in developing it.

## Basic Requirements

Obvisouseliy, you should have Docker installed in your environment. If you don't have Docker installed yet, check out my post on [Getting started with Docker](https://mic-bac.netlify.app/posts/getting-started-with-docker/).

Create a folder where you would like to save your Dockerfile and any additional files you might need.

That's pretty much it! Now you're good to start customizing your Docker image.


## Dockerfile

If you want to run your app in a container, you can use a Dockerfile. In the following, I provided a basic example to give you an idea how it could work, including some extras [optional].

In your Dockerfile, you'll need to add some arguments. Some of them are required and some are useful to specifiy your custom image:

- `FROM` initializes a new build stage and sets the Base Image for subsequent instructions. A valid Dockerfile must start with the `FROM` instruction.
- `ARG` is the only instruction that may precede `FROM` in the Dockerfile. It's basically used to specify variables in a Dockerfile. But, if it's called before `FROM` it's declared as being outside the building stage and cannot be used in further steps. If needed, you'll have to call it again after `FROM` without a value.
- `WORKDIR` sets the working directory for any `RUN`, `CMD`, `ENTRYPOINT`, `COPY` and `ADD` instructions that follow it in the Dockerfile. If the `WORKDIR` doesn't exist, it will be created even if it's not used in any subsequent Dockerfile instruction.
- `COPY` copies new files or directories from the source and adds them to the filesystem of the container at the path destination `COPY <src> <dest>`.
- `RUN` will execute any commands in a new layer on top of the current image and commit the results. The resulting committed image will be used for the next step in the Dockerfile. `RUN` can either be used in shell form `RUN <command>` or exec form `RUN ["executable", "param1", "param2"]`. The exec form is parsed as a JSON array, which means that you must use double-quotes (") around words not single-quotes (').
- `CMD` can only be called once in a Dockerfile (last `CMD` will take effect). It's preferred to be used in the exec form CMD `["executable","param1","param2"]`.



```
# [optional] add arguments for FROM
ARG VERSION=3.8

# chose your source
FROM python:${VERSION}

# [optional] add working directory if needed
WORKDIR /usr/src

# [optional] copy requirements for installation
COPY requirements.txt .

# [optional] install requirements
RUN pip install --no-cache-dir -r requirements.txt

# copy everything
COPY . .

# command to run on container start
CMD ["python", "./example.py"]
```

The above example also requires a *requirements.txt* file indicating the necessary python libraries you would like to install in your container. For this example I don't really need one but, I'd like to give an example of how you could make use of it.

Your Docker file is executed sequentially and builds up your image. You need just one line of code in your terminal:

```
$ docker build -t examplepy:hello /path/to/docker-file/location/
```

You should see the status of every step you specified in your Dockerfile.

```
Sending build context to Docker daemon  4.096kB
Step 1/7 : ARG VERSION=3.8
Step 2/7 : FROM python:${VERSION}
3.8: Pulling from library/python

...

Successfully built deeb932bac19
Successfully tagged examplepy:hello
```

And you can run your docker container.

```
$ docker run --rm -it examplepy:hello
```

With the following result (hopefully :)):

```
Hello Docker World!
Pandas found:
True
```



I hope this post was informative. Feel free to contact me for any feedback :)




